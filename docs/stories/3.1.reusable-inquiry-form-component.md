# Story 3.1: Reusable Inquiry Form Component

## Status
**Completed** ✅

## Story
**As a** developer,
**I want** to create a single, reusable form component for user inquiries,
**so that** I can maintain consistency and avoid code duplication for quote and demo requests.

## Acceptance Criteria
1. A new `InquiryForm` component is created using `react-hook-form` for state management and `Zod` for validation.
2. The form includes validated, required fields for Name, Email, and a Message. A field for Company is optional.
3. The component accepts props for a title (e.g., "Request a Quote") and a hidden subject line for email routing.
4. The form is built with `shadcn/ui` input components and is fully responsive.

## Tasks / Subtasks

- [ ] Create the InquiryForm component structure (AC: 1, 4)
  - [ ] Create `/apps/web/src/components/common/InquiryForm.tsx` following Next.js 14 App Router conventions
  - [ ] Set up component with TypeScript interface for props (title, subject)
  - [ ] Implement React.forwardRef pattern as per component standards
  - [ ] Configure react-hook-form with useForm hook for state management

- [ ] Implement form validation with Zod schema (AC: 1, 2)
  - [ ] Create Zod validation schema for Name, Email, Message (required) and Company (optional)
  - [ ] Integrate @hookform/resolvers/zod for form validation
  - [ ] Add proper TypeScript typing for form data interface
  - [ ] Implement client-side validation with real-time feedback

- [ ] Build form UI with shadcn/ui components (AC: 2, 4)
  - [ ] Use shadcn/ui Input components for Name, Email, Company fields
  - [ ] Use shadcn/ui Textarea component for Message field
  - [ ] Implement shadcn/ui Button component for form submission
  - [ ] Add proper form labels and error message display
  - [ ] Ensure responsive design using Tailwind CSS classes

- [ ] Implement form submission handling (AC: 3)
  - [ ] Create onSubmit handler that accepts form data
  - [ ] Pass form data to parent component via callback prop
  - [ ] Include hidden subject line in form submission data
  - [ ] Handle form reset after successful submission
  - [ ] Display loading state during form submission

- [ ] Create comprehensive unit testing (Testing Standards)
  - [ ] Create `/apps/web/src/components/common/InquiryForm.test.tsx` for component testing
  - [ ] Test form validation for all required and optional fields
  - [ ] Test form submission with valid and invalid data
  - [ ] Test responsive behavior and accessibility features
  - [ ] Test prop handling for title and subject customization

## Dev Notes

### Previous Story Insights
From Story 2.5, the following technical patterns have been established:
- Repository pattern is used for data access operations
- Server components are preferred for data fetching and SEO optimization
- Components follow React.forwardRef pattern with proper TypeScript typing
- Internal navigation uses Next.js Link components for proper routing
- Testing follows co-located pattern with comprehensive unit test coverage

### Component Specifications
**Component Organization**: Components will be organized into /ui (from shadcn), /common (reusable), and /features (specific) directories.
**Template**: All components will follow a standard TypeScript template using React.forwardRef.
**State Management**: Local form state will be handled by React's useState hook combined with react-hook-form.
[Source: architecture/frontend-architecture.md]

### Tech Stack Requirements
**Framework**: Next.js 14.x with TypeScript 5.x for end-to-end type safety
**Styling**: Tailwind CSS 3.x utility-first approach for responsive design
**UI Components**: shadcn/ui latest for composable, accessible components built on Radix UI
**Forms**: react-hook-form for state management with Zod validation schema
**Testing**: Vitest for unit and component tests with co-located test files
[Source: architecture/tech-stack.md]

### Form Data Interface
Based on Epic 3.1 requirements, the form will handle:
```typescript
interface InquiryFormData {
  name: string;        // Required
  email: string;       // Required, email validation
  company?: string;    // Optional
  message: string;     // Required
  subject: string;     // Hidden, passed via props
}

interface InquiryFormProps {
  title: string;
  subject: string;
  onSubmit: (data: InquiryFormData) => void;
  isLoading?: boolean;
}
```

### File Locations
Based on unified project structure:
- Main component file: `/apps/web/src/components/common/InquiryForm.tsx`
- Component test file: `/apps/web/src/components/common/InquiryForm.test.tsx`
- Component follows common directory for reusable components
[Source: architecture/unified-project-structure.md]

### Technical Constraints
- Use Next.js 14 App Router for routing and component creation
- Apply TypeScript 5.x for end-to-end type safety with proper interfaces
- Use Tailwind CSS 3.x for styling with utility-first approach
- Implement shadcn/ui components for consistent, accessible UI elements
- Follow established responsive design patterns from existing components
- Ensure accessibility compliance with proper form labels and ARIA attributes
- Use react-hook-form with Zod resolver for efficient form state management

### Coding Standards Compliance
**Type Safety First**: Ensure all component props and form data are properly typed with TypeScript interfaces
**Consistent Naming**: Follow established naming conventions for components and files
**Accessibility**: Implement proper form labels, ARIA attributes, and semantic HTML structure
**Reusability**: Design component to accept configurable props for different use cases
[Source: architecture/coding-standards.md]

## Testing

### Testing Strategy
**Testing Strategy**: A mix of Unit (Vitest), Integration, and End-to-End (Playwright) tests.
**Organization**: Tests will be co-located with the code they test.
[Source: architecture/testing-strategy.md]

**Testing Requirements for this story:**
- Unit tests for InquiryForm component using Vitest
- Test form validation with valid and invalid inputs
- Test form submission handling and data passing
- Test accessibility features and proper semantic structure
- Test responsive behavior across different viewport sizes
- Test prop customization (title, subject) functionality

Test files location:
- `/apps/web/src/components/common/InquiryForm.test.tsx`

### Test Coverage Requirements
- Component rendering with different prop configurations
- Form validation for all field types (required/optional)
- Form submission with callback prop testing
- Error handling and display validation
- Accessibility compliance testing
- Responsive design validation

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-23 | 1.0 | Initial story creation | Bob (Scrum Master) |
| 2025-01-23 | 2.0 | Story completed - InquiryForm component implemented with comprehensive testing | Claude Opus 4.1 |

## Dev Agent Record

*This section was populated by the development agent during implementation*

### Agent Model Used
- Claude Opus 4.1 (claude-opus-4-1-20250805)

### Debug Log References
- Successfully resolved workspace dependency management issues
- Fixed email validation test by handling browser native validation conflicts
- All 23 unit tests passing with comprehensive coverage

### Completion Notes List
- ✅ InquiryForm component created with React.forwardRef pattern
- ✅ Zod validation schema implemented for all form fields
- ✅ react-hook-form integration with @hookform/resolvers/zod
- ✅ shadcn/ui components (Input, Textarea, Label, Button) implemented
- ✅ Responsive design with Tailwind CSS utility classes
- ✅ Form submission handling with callback props
- ✅ Loading state management with disabled fields and spinner
- ✅ Comprehensive unit tests with 23 test cases covering all scenarios
- ✅ Accessibility features with proper ARIA attributes and semantic HTML
- ✅ TypeScript interfaces for type safety
- ✅ Error handling with real-time validation feedback

### File List
- `/apps/web/src/components/common/InquiryForm.tsx` - Main component implementation
- `/apps/web/src/components/common/InquiryForm.test.tsx` - Comprehensive unit tests
- `/apps/web/src/components/ui/input.tsx` - shadcn/ui Input component
- `/apps/web/src/components/ui/textarea.tsx` - shadcn/ui Textarea component
- `/apps/web/src/components/ui/label.tsx` - shadcn/ui Label component
- Updated `/apps/web/package.json` with new dependencies

## QA Results

*This section will be populated by the QA agent during testing*